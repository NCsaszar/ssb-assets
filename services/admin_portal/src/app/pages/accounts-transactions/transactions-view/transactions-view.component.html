<div class="component-container">
  <mat-card>
    <mat-card-header>
      <mat-card-title class="mat-card-title">Transactions</mat-card-title>
    </mat-card-header>
    <mat-divider></mat-divider>

    <div class="filters-container" [formGroup]="filters">
      <div class="filter-box">
        <mat-form-field>
          <mat-label>Transaction Type</mat-label>
          <mat-select formControlName="transactionType">
            <mat-option *ngFor="let type of transactionTypes" [value]="type">
              {{ type }}
            </mat-option>
          </mat-select>
        </mat-form-field>
        <mat-form-field appearance="fill">
          <mat-label>Min Amount</mat-label>
          <input
            matInput
            placeholder="Min Amount"
            formControlName="minAmount"
            type="number"
          />
        </mat-form-field>
        <mat-form-field appearance="fill">
          <mat-label>Max Amount</mat-label>
          <input
            matInput
            placeholder="Max Amount"
            formControlName="maxAmount"
            type="number"
          />
        </mat-form-field>
        <mat-form-field color="primary">
          <mat-label>Enter a date range</mat-label>
          <mat-date-range-input [rangePicker]="picker" [formGroup]="filters">
            <input
              matStartDate
              formControlName="start"
              placeholder="Start date"
            />
            <input matEndDate formControlName="end" placeholder="End date" />
          </mat-date-range-input>
          <mat-hint class="date-hint">MM/DD/YYYY â€“ MM/DD/YYYY</mat-hint>
          <mat-datepicker-toggle
            matIconSuffix
            [for]="picker"
          ></mat-datepicker-toggle>
          <mat-date-range-picker #picker></mat-date-range-picker>
        </mat-form-field>
      </div>
      <mat-form-field appearance="outline">
        <input
          matInput
          placeholder="Search by Last 4 Digits"
          formControlName="lastFour"
        />
        <button
          matSuffix
          mat-icon-button
          aria-label="Search"
          color="primary"
          (click)="performSearch()"
        >
          <mat-icon>search</mat-icon>
        </button>
      </mat-form-field>
    </div>
    <div class="clear-filters">
      <button mat-stroked-button class="clear-filters" (click)="clearFilters()">
        Clear Filters
      </button>
    </div>
    <mat-card-content>
      <table
        matSort
        class="mat-elevation-z8"
        mat-table
        [dataSource]="dataSource"
      >
        <ng-container matColumnDef="transactionId">
          <th mat-header-cell *matHeaderCellDef>Transaction ID</th>
          <td mat-cell *matCellDef="let element">
            {{ element.transactionId }}
          </td>
        </ng-container>

        <ng-container matColumnDef="accountNumber">
          <th mat-header-cell *matHeaderCellDef>Account #</th>
          <td mat-cell *matCellDef="let element">
            {{ element.accountNumber }}
          </td>
        </ng-container>

        <ng-container matColumnDef="transactionType">
          <th mat-sort-header mat-header-cell *matHeaderCellDef>
            Transaction Type
          </th>
          <td mat-cell *matCellDef="let element">
            {{ element.transactionType.toUpperCase() }}
          </td>
        </ng-container>

        <ng-container matColumnDef="amount">
          <th mat-sort-header mat-header-cell *matHeaderCellDef>Amount</th>
          <td mat-cell *matCellDef="let element">
            {{ element.amount | currency : "USD" : true : "1.2-2" }}
          </td>
        </ng-container>

        <ng-container matColumnDef="dateTime">
          <th mat-sort-header mat-header-cell *matHeaderCellDef>
            Date of Transaction
          </th>
          <td mat-cell *matCellDef="let element">
            {{ element.dateTime | date : "medium" }}
          </td>
        </ng-container>

        <ng-container matColumnDef="description">
          <th mat-header-cell *matHeaderCellDef>Description</th>
          <td mat-cell *matCellDef="let element">
            {{ element.description }}
          </td>
        </ng-container>

        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef>Reverse</th>
          <td mat-cell *matCellDef="let element">
            <button
              mat-icon-button
              (click)="reverseTransaction(element)"
              [disabled]="element.transactionType === 'Reversal'"
            >
              <mat-icon
                [ngClass]="{
                  'icon-disabled': element.transactionType === 'Reversal'
                }"
                color="warn"
                >sync</mat-icon
              >
            </button>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
      </table>
    </mat-card-content>
    <br />
    <mat-card-footer>
      <mat-paginator
        [pageSizeOptions]="[5, 10, 25, 100]"
        showFirstLastButtons
      ></mat-paginator>
    </mat-card-footer>
  </mat-card>
</div>
